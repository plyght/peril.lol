let currentPhoto=null;function openLightbox(p){currentPhoto=p;const l=document.getElementById('lightbox'),i=document.getElementById('lightbox-img'),info=document.getElementById('lightbox-info');i.src=p.filename;i.alt=p.title;info.innerHTML=generateLightboxInfoHTML(p);l.classList.add('active')}function closeLightbox(){document.getElementById('lightbox').classList.remove('active')}function viewFullResolution(){if(currentPhoto)window.open(currentPhoto.filename,'_blank')}document.addEventListener('keydown',e=>{if(e.key==='Escape')closeLightbox()});(async()=>{const g=document.getElementById('gallery');showLoading(g);try{const photos=await fetchPhotos();g.innerHTML='';photos.forEach(p=>{const c=document.createElement('div');c.style.position='relative';const i=document.createElement('img');i.src=p.filename;i.alt=p.title;i.loading='lazy';i.onclick=()=>openLightbox(p);c.appendChild(i);g.appendChild(c)})}catch{showError(g,'Error loading photos. Please try again.')}})()